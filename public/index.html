<!DOCTYPE html>
<html>
  <head>
    <title>JavaScript - A-Frame School</title>
    <meta name="description" content="JavaScript - A-Frame School">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="index.js"></script>
    <div style='position: fixed; top: 10px; width:100%; text-align: center; z-index: 1;'>
      <button>
        Click to Add Weather
      </button>
    </div>
  </head>
  <body>
    <a-scene playground>
      <a-plane id= "plane" position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4">

      </a-plane>
      <a-sky color="#87CEEB"></a-sky>
    </a-scene>
  </body>
</html>
<script>
  navigator.geolocation.getCurrentPosition(
          function(position){
            console.log(position);
            let longitude = position.coords.longitude;
            let latitude = position.coords.latitude;
            let btn =  document.querySelector("button");

            //点击按钮发起Ajax请求，传送geocode
            btn.onclick = function(){

              let xhr = new XMLHttpRequest();

              xhr.open("get","http://localhost:3000/api?longitude="+longitude+"&latitude="+latitude);

              xhr.send();

              xhr.onload = function(){
                console.log(xhr.responseText);
                var component = document.querySelector('[playground]').components.playground;
                console.log(component);
                component.addItem(xhr.responseText);
              }
            }
          },
          function(error){
            alert("Request Failure! "+error.code+" , "+error.message);
          },
  );
</script>

